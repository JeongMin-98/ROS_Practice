# 영상의 이진화

영상의 픽셀 값을 0 또는 255(1)로 만드는 연산

+ 목적
  + 영상 내에서 배경인지 객체인지 판단하기 위해서
  + 영상 내 관심영역과 비관심영역을 분리하기 위해서


## 이진화 방법

+ 그레이 스케일 영상의 이진화
  + 간단한 임계값 연산을 이용
  + 영상에서 원하는 결과에 맞는 적정한 임계값을 찾는 것이 중요

**간단한 이진화 방법**
```cpp
Mat mag;
Mat dst = mag > 120;
```

**임계값 연산 함수**
```cpp
double threshold( InputArray src, OutputArray dst,
                  double thresh, double maxval, int type );
```
+ src: 입력 영상, 다채널, 8비트 또는 32비트 실수형
+ dst: 출력 영상, src와 동일 크기, 타입, 채널 수를 가짐
+ thresh: 사용자 지정 임계값
+ maxval: THRESH_BINARY or THRESH_BINARY_INV 방법 시 최댓값
+ type: 임계값에 의한 변환 함수 지정 또는 자동 임계값 설정 방법 지정
  + 자동 인계값 flag를 같이 사용하게되면 임계값이 자동으로 설정된다. 
+ 반환값: 사용된 임계값

### threshold() type 설명
![type](img/threshold_type.png)
![type](img/type_math.png)


## 자동 임계값 결정 방법
전경과 배경의 픽셀 분포가 비슷하게되고 bimodal인 히스토그램을 보인다면
픽셀 값의 평균을 구하면 이진화가 잘 된다. 

> bimodal이지만 전경과 배경의 픽셀 분포가 크게 다르다면 영상의 이진화는 잘 이루어지지 않는다.

### Otsu 이진화 방법
+ 입력 영상이 배경과 객체 두 개로 구성되어있다고 가정(bimodal)
+ 임의의 임계값 T에 의해 나눠지는 두 픽셀 분포 그룹의 분산이 최소가 되는 T를 선택
+ 일종의 최적화 알고리즘

**사용법**
+ Threshold() 함수의 type 인자에 THRESH_OTSU를 지정

> 영상의 조명 성분이 불균일하다면 전역 이진화를 하게된다면 완벽한 이진화가 이루어지지않는다. 

+ 불균일한 조명 성분을 보상한 후 전역 이진화를 수행하는 것은 쉽지않다. 

# 지역 이진화
전역 이진화의 문제를 해결하기 위해서 지역 이진화를 수행한다. 
+ 픽셀 또는 영역마다 다른 임계값을 사용하여 이진화를 수행한다. 
+ 특정 크기 영역으로 분할하여 이진화를 수행하거나 각 픽셀 근방에 윈도우를 설정하여 임계값을 결정하여 이진화를 수행한다. 

**구현 중 요구사항**
1. 영역 또는 윈도우의 크기
2. 윈도의 형태는 Uniform, Gaussian?
3. 윈도우를 겹칠 것인가?
4. 윈도우 안에 배경 또는 객체만 존재한다면?

**적응형 이진화**
```cpp
adaptiveThreshold

```



