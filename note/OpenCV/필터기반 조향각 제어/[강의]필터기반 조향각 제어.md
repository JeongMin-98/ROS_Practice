# 필터기반 조향각 제어

> 자동차 운전은 조향 및 속도를 제어하는 과정

+ 조향각 제어는 직선차로에서는 정면으로 곡선차로에서는 적절한 조향각을 설정할 필요가있다.
+ 속도 제어는 속도가 너무 빠르면 곡선 주행에서 미끄러져질수있음



## 차선 위치 정보를 이용하여 조향각 제어

1. 양쪽 차선의 위치를 찾아서 양쪽 차선의 중간값을 구한다. 
2. 양쪽 차선의 중간값을 화면의 중앙과 비교해서 얼마만큼 떨어져 있는지를 계산한다. 
3. 떨어진 간격만큼 핸들을 꺽는다. (조향각 제어)

> 떨어진 픽셀 간격에 따라 몇 도 씩 꺾어야 하는지 설정해야한다.

### 차선 인식의 한계점

+ 빛, 그늘, 반사광, 장애물 때문에 차선이 가리는 경우
+ 급커브등 차선이 시야에서 벗어나 안보이는 경우
+ 차선 인식에 오류가 심하면 조향각 변동이 심해진다.

## 안정적인 주행

부드러운 핸들링이 필요하다 => 조향각 값에 대한 필터링이 필요

조향각이 계산되어 나온것을 필터링을 통해서 모터 제어 토픽을 발행

### 간단한 필터

+ 평균 필터
+ 이동 평균 필터 (오래된 데이터를 버리는 필터)
+ 가중 이동평균 필터 : 10개의 데이터를 모으는데 가중치를 곱해서 평균을 구한다. 
+ 저주파 통과 필터 : 지수로 가중치를 더해서 필터를 적용

## 필터 기반 조향각 제어

+ 이동평균 필터 (과거 값은 버리자)
+ 가중 이동평균 필터 최신 값이 중요
+ 차선 위치? 조향각 데이터?

필터는 class로 구현

+ 과제 1 => 조향각이 아닌 차선위치 데이터에 적용
+ 과제 2 => 차량의 속도가 느릴때 빠를때 어떤 필터가 효과적인지 알아보자