# 캐니 에지 검출

> 소벨 필터는 비교적 간단한 필터링 연산과 임계값 연산으로 에지 위치를 검출 할 수 있었으나 
> 그래디언트 크기만 사용하기 때문에 에지 위치가 여러개의 픽셀로 표현 될 수 있다.

+ 그래디언트의 크기 변환값을 잘 분석하여 local Maximum 부분의 픽셀을 엣지 부분으로 검출하는 것이 목표
## 캐니가 제안한 에지 검출기의 조건
+ 정확한 검출
  + 에지가 아닌 점을 에지로 찾는 것을 최소화
  + 에지를 검출하지 못하는 확률을 최소화
+ 정확한 위치
  + 실제 에지의 중심을  검출
+ 단일 에지
  + 하나의 에지는 하나의 점으로 표현

## 캐니 에지 검출 방법
1. 가우시안 필터링
2. 그래디언트 계산
   + 주로 소벨 마스크를 사용
   + 그래디언트 방향을 4개의 구역으로 단순화한다. 
   + 가로, 세로, 왼쪽 위에서 부터 오른쪽 아래의 대각선, 오른쪽 위에서부터 왼쪽 아래의 대각선
   + 4개로 단순화된 방향을 비최대 억제에서 사용된다. 
3. 비최대 억제
4. 이중 임계값을 이용한 히스테리시스 에지 트래킹


### 비최대 억제

**Non-maximum suppression**
+ 하나의 에지가 여러개의 픽셀로 표현되는 현상을 없애기 위해 그래디언트 크기가 국지적 최대인 픽셀만을 에지 픽셀로 설정한다. 
+ 그래디언트 방향에 위치한 두개의 픽셀과 국지적 최대를 검사한다. 
+ 에지의 방향, 그래디언트 방향을 확인
+ 그래디언트 방향에 있는 픽셀의 값을 서로 비교하여 국지적 최대인 픽셀만을 에지 픽셀로 설정한다. 

### 히스테리시스 에지 트래킹
> 이중 임계값을 이용한다. 

+ Threshold_LOW, Threshold_HIGH
+ 강한 에지: 무조건 최종 에지로 선정
+ Threshold_LOW보다 작으면 절대 에지가 아니다. 
+ 두 임계값 사이의 값이면 약한 에지이다. 

**캐니 에지 검출기**
```cpp
void Canny( InputArray image, OutputArray edges,
                         double threshold1, double threshold2,
                         int apertureSize = 3, bool L2gradient = false );

```
+ image: 입력 영상
+ edges: 에지 영상(출력값) CV_8UC1
+ threshold1: 하단 임계값
+ threshold2: 상단 임계값
+ apertureSize: 소벨 연산을 위한 커널 크기
+ L2gradient: L2 norm 사용여부
