# Image Space vs Parameter Space

+ Image Space(x,y 좌표계)
+ Parameter Space(기울기와 절편)

Image space에서의 직선은 기울기와 y절편으로 Parameter Space에서 점으로 표현할 수 있다. 

이런 관계는 역으로도 존재한다.

Parameter Space에서의 직선은 Image Space에서 (x1, y1) 점을 지나는 모든 직선을 의미한다.



Parameter Space에서의 교점은 m과 b가 같은 경우에 생기고 Image Space에서 두 점을 지나는 직선을 의미한다.

### Parameter Space의 교점

+ 직선을 찾는 방법
  + Canny를 통해 외곽선(edge)를 찾고 그 edge의 점들을 parameter space로 표현한다.  겹치는 직선이 많은 교점일 수록 교점이 image Space에서 표현한다면 직선이 존재할 가능성이 높음

### Parameter Space 의 한계

기울기가 무한대인 직선은 표현이 어렵다. 이런 점 때문에 parameter space에서 표현할 수 없어서 **Hough Space**를 도입했다.

# Hough Space

원점에서 직선에 수선의 발을 내려서 수선을 긋고 원점과 직선과의 거리와 수선과 x축과의 각도를 Hough Space로 표현한다.

+ Image Space에서 점은 Hough Space에서 곡선으로 표현된다.

# Hough Transform

+ 세 점의 angle과 Distance 값
  + 한 점을 지나는 여러 각도의 선과 원점간의 거리를 구하면 Hough 스페이스에 곡선을 그린다.
  + Hough Space에서 곡선들이 만나는 점을 다시 Image Space로 변환하면 3개의 점을 모두 지나는 직선임을 알게된다.
+ angle과 Distance의 간격은 어떻게 할 것인가
  + 특정 값 사이에 있는 점도 같은 직선 위에 있다고 할 것인가?

## 직선 검출 방식

1. 입력 영상을 흑백 변환 처리
2. Canny Edge처리로 외곽선 영상을 획득
3. angle과 distance 간격을 설정
4. 외각선 점들에 대해서 (distance, angle) 좌표 값을 구한다.
5. 오차 범위 내의 좌표값을 갖는 외곽선 점들이 하나의 직선을 구성한다고 판정

## HoughLines 함수

+ cv2.HoughLines(image, rho, theta, threshold)
  + image : 흑백 이미지
  + rho: 얼마만큼 distance를 증가시키면서 조사할 것인지
  + theta: 얼마만큼 angle을 증가시키면서 조사할 것인지
  + threshold: threshold 이상의 직선이 겹치는 교점은 하나의 직선을 형성한다고 판단
  + threshold값이 높으면 검출되는 직선은 적지만 확실한 직선들이 검출됨
  + 그 반대의 경우 불확실한 직선들도 검출된다.

## HoughLinesP 함수

+ HoughLinesP(image, rho, theta, threshold, minLineLength, maxLineGap)
  + minLineLength : 선분의 최소 길이, 이것보다 짧은 선분은 버린다.
  + maxLineGap: 간격의 최대 길이, 이것보다 작은 간격은 하나의 선분으로 간주
  + 검출된 선분의 시작점과 끝점의 좌표를 반환

# 허프변환을 이용한 차선 찾기

작업 프로세스

+ image read
+ GrayScale
+ Gaussian Blur
+ Canny
+ ROI
+ HoughLinesP